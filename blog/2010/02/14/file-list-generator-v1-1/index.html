<!doctype html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="Description" content="Karun Japhet's blog">
  <title>Ramblings of a Coder's Mind by Karun Japhet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

  <body>
    <div class="wrapper">
      <header>
  <h1 class="header"><a href="/">Ramblings of a Coder's Mind</a></h1>
  <p class="header">Got Tech? Will Hack.</p>
</header>


      <section>
        <section>
  <h1 class="entry-title">File list generator v1.1</h1>
  <p>On a lazy Sunday afternoon when you’ve got nothing better to do, you either write <a href="http://blog.karun.me/blog/2009/12/06/clean-file-list-generation-with-powershell-script/">rather useless scripts</a> or update them. I chose to do the latter.</p>

<p>The <a href="Clean%20File%20List%20Generation%20with%20PowerShell%20Script">file list generation script</a> I wrote some time back was mainly to generate a list of movies I have. When I generated a list of all the HD movies I have on disk, I realized, my list was being ruined by loads of sample files which escape the file filter because they are the same extension as the videos themselves. So I decided to write a simple fix to remove all files with “sample” in it. Of course, this is activated by a command line switch which is by default off. The extension list now ignores all images (pngs, jpgs and bmps) so my file list no longer has any screen shots.</p>

<p>Here’s a couple of sample script calls</p>

<blockquote>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe _-command_ "**&amp; 'C:\Users\Karun\My Scripts\filelist.ps1**'" "**H:\Movies\HQ**"
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe _-command_ "**&amp; 'C:\Users\Karun\My Scripts\filelist.ps1**'" "**H:\Movies******" "**true**"
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe _-command_ "**&amp; 'C:\Users\Karun\My Scripts\filelist.ps1**'" "**H:\Movies******" "**true**" "**true**"</blockquote>

<p>The first one will call on the script and generate an output. The second will do so recursively. The third one will ignore all files with the word “sample” in them. Simple enough? Go <a href="http://svn.jalife.net/Random__Code/markup/HEAD/PowerShell___filelist.ps1" target="_blank" rel="noopener noreferrer">get the code</a> and have fun with it!</p>

<table>
  <tbody>
    <tr>
      <td><a href="http://svn.jalife.net/Random__Code/markup/HEAD/PowerShell___filelist.ps1" target="_blank" rel="noopener noreferrer">View Script Source Code</a></td>
      <td><a href="http://svn.jalife.net/Random__Code/downloadfile/HEAD/PowerShell___filelist.ps1" target="_blank" rel="noopener noreferrer">Download Script Source Code</a></td>
    </tr>
  </tbody>
</table>

<p>If you’re having trouble executing the script, you should consider signing your PowerShell scripts. <a href="http://www.hanselman.com/blog/SigningPowerShellScripts.aspx" target="_blank" rel="noopener noreferrer">Scott Hanselman has written a great post on how to do so</a>. Go read it! You could simply <em>Set-ExecutionPolicy</em> to <em>Unrestricted</em> but then you’d be leaving your system open to attacks. Don’t blame anyone but yourself if you run someone else’s unsafe code and screw something up :) You have been warned :)</p>


  <span>
  

  <strong>Created</strong>: 14th February 2010
  
</span>
<br>
  

<span>
  <strong>Category</strong>:
  Development
</span>

<br>
  

<span>
  <strong>Tags</strong>:
  File List Generator, PowerShell, Scripts, Source
</span>



  
    <h2>Comments</h2>

    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function () {
        this.page.url = 'https://blog.karun.me/blog/2010/02/14/file-list-generator-v1-1/';
        this.page.identifier = 'https://blog.karun.me/blog/2010/02/14/file-list-generator-v1-1/';
      };

      (function() {
        var d = document, s = d.createElement('script');
        s.src = 'https://roacm.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="noopener noreferrer" target="_blank">comments powered by Disqus.</a>
</noscript>
  
</section>

      </section>

      <footer>
  <h3>About</h3>
  <p><a href="https://karun.me" target="_blank" rel="noopener noreferrer">Karun Japhet</a> is a human.<br>Writes code at Sahaj Software. Speaks publicly about scaling software, testing, CD &amp; ML. Loves riding motorcycles and playing CS:GO</p>
  <p><small><a href="/about">Read on →</a></small></p>

  <h3>Contact</h3>
  <p id="contact">
      
      <a href="https://github.com/javatarz" aria-label="GitHub" target="_blank" rel="noopener noreferrer"><i class="fab fa-github fa-lg"></i></a>
      
      <a href="https://stackoverflow.com/users/499797" aria-label="Stack Overflow" target="_blank" rel="noopener noreferrer"><i class="fab fa-stack-overflow fa-lg"></i></a>
      
      <a href="https://twitter.com/javatarz" aria-label="Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter fa-lg"></i></a>
      
      <a href="https://www.linkedin.com/in/karunjaphet" aria-label="LinkedIn" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin fa-lg"></i></a>
      
      <a href="mailto:karun@japhet.in" rel="tooltip" title="karun@japhet.in" target="_blank"><i class="fa fa-envelope fa-lg"></i></a>
      <a href="/atom.xml" title="RSS Feed" target="_blank" rel="noopener"><i class="fa fa-rss fa-lg"></i></a>
  </p>

  <p>
    <small>
      Copyright © 2006 - 2021 <br>
      <a href="https://karun.me" target="_blank" rel="noopener noreferrer">Karun Japhet</a> <br>
      Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a>
    </small>
  </p>
</footer>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    

    

    <noscript id="deferred-styles">
    <link href="https://fonts.googleapis.com/css?family=Arvo:400,700,400italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <link rel="stylesheet" href="/assets/css/overrides.css?v=">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/solid.css" integrity="sha384-rdyFrfAIC05c5ph7BKz3l5NG5yEottvO/DQ0dCrwD8gzeQDjYBHNr1ucUpQuljos" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/brands.css" integrity="sha384-QT2Z8ljl3UupqMtQNmPyhSPO/d5qbrzWmFxJqmY7tqoTuT2YrQLEqzvVOP2cT5XW" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/fontawesome.css" integrity="sha384-u5J7JghGz0qUrmEsWzBQkfvc8nK3fUT7DCaQzNQ+q4oEXhGSx+P2OqjWsfIRB8QT" crossorigin="anonymous">
    <script src="/assets/js/scale.fix.js"></script>
</noscript>
<script>
    var loadDeferredStyles = function() {
    var addStylesNode = document.getElementById("deferred-styles");
    var replacement = document.createElement("div");
    replacement.innerHTML = addStylesNode.textContent;
    document.body.appendChild(replacement)
    addStylesNode.parentElement.removeChild(addStylesNode);
    };
    var raf = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
        window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
    if (raf) raf(function() { window.setTimeout(loadDeferredStyles, 0); });
    else window.addEventListener('load', loadDeferredStyles);
</script>
  </body>
</html>
